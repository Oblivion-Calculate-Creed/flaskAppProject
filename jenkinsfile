pipeline {
  agent any
  environment{
      dockerusername=credentials('dockerusername')
      dockerpass=credentials('dockerpass')
  }
  stages  {
    stage('Tests and Builds') {
      steps {
        sh 'sudo bash ./scripts/remote_pytest.sh'
      }
    }
    stage('Log in to Docker') {
        steps {
            sh 'sudo docker login --username=${dockerusername} --password=${dockerpass}'
        }
    }
    stage('Docker-push to FrontEnd') {
        steps {
              sh 'sudo bash ./scripts/docker_push_frontend.sh'
        }
    }
    stage('Docker-push to BackEnd') {
        steps {
              sh 'sudo bash ./scripts/docker_push_backend.sh'
        }
    }
    stage('Deploy with Kubernetes') {
          steps {
              sh 'sudo bash ./scripts/deploykub.sh'
        }
    }
  }
}
